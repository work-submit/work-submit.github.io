<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title"><span style="color: #5ab0c5  ;font-weight: bolder;">DMDiff</span>: Degradation-Modeled Multipath Diffusion for Tunable Metalens Photography<br></h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://dmdiff.github.io/">Jianing Zhang</a><sup>2, 3</sup></span>&nbsp;&nbsp;
            <span class="author-block">
              <a href="https://dmdiff.github.io/">Jiayi Zhu</a><sup>1</sup></span>&nbsp;&nbsp;
            <span class="author-block">
              <a href="https://dmdiff.github.io/">Feiyu Ji</a><sup>1</sup></span>&nbsp;&nbsp;
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=yDEavdMAAAAJ&amp;hl=en">Xiaokang Yang</a><sup>1</sup></span>&nbsp;&nbsp;
            <span class="author-block">
              <a href="https://xiaoyunyuan.net/">Xiaoyun Yuan</a><sup>1</sup></span>&nbsp;&nbsp;
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>MoE Key Lab of Artificial Intelligence, AI Institute, Shanghai Jiao Tong University</span>&nbsp;&nbsp;
            <span class="author-block"><sup>2</sup>Fudan University</span>&nbsp;&nbsp;
            <span class="author-block"><sup>3</sup>Tsinghua University</span>
            <br>
            <span class="email-link">
              <a href="mailto:yuanxiaoyun@sjtu.edu.cn">yuanxiaoyun@sjtu.edu.cn</a>
              &nbsp;&nbsp;
              <!-- <a href="mailto:tonghe90@gmail.com">tonghe90@gmail.com</a> -->
            </span>
          </div>

          <div class="is-size-4 publication-title"><span style="color: #ee7e61; font-weight: bolder;">ICCV 2025</span><br></div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->

              <span class="link-block">
                <a href="https://dmdiff.github.io/paper/ICCV2025.pdf" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <svg class="svg-inline--fa fa-file-pdf fa-w-12" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-pdf" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"></path></svg><!-- <i class="fas fa-file-pdf"></i> Font Awesome fontawesome.com -->
                  </span>
                  <span>PDF</span>
                </a>
              </span>

              <span class="link-block">
                <a href="https://arxiv.org/abs/2506.22753" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>

              <span class="link-block">
                <a href="https://github.com/yuanxy92/DMDiff_ICCV2025" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github"></i> Font Awesome fontawesome.com -->
                  </span>
                  <span>Code</span>
                  </a>
              </span>

              <span class="link-block">
                <a href="https://pan.sjtu.edu.cn/web/share/ebafd0ff28a601db09b58744a5b914d1" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <svg class="svg-inline--fa fa-camera-retro fa-w-16" aria-hidden="true" focusable="false" data-prefix="fa" data-icon="camera-retro" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M48 32C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48H48zm0 32h106c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H38c-3.3 0-6-2.7-6-6V80c0-8.8 7.2-16 16-16zm426 96H38c-3.3 0-6-2.7-6-6v-36c0-3.3 2.7-6 6-6h138l30.2-45.3c1.1-1.7 3-2.7 5-2.7H464c8.8 0 16 7.2 16 16v74c0 3.3-2.7 6-6 6zM256 424c-66.2 0-120-53.8-120-120s53.8-120 120-120 120 53.8 120 120-53.8 120-120 120zm0-208c-48.5 0-88 39.5-88 88s39.5 88 88 88 88-39.5 88-88-39.5-88-88-88zm-48 104c-8.8 0-16-7.2-16-16 0-35.3 28.7-64 64-64 8.8 0 16 7.2 16 16s-7.2 16-16 16c-17.6 0-32 14.4-32 32 0 8.8-7.2 16-16 16z"></path></svg><!-- <i class="fa fa-camera-retro"></i> Font Awesome fontawesome.com -->
                  </span>
                  <span>Data</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-four-fifths">
        <img src="./projects/DMDiff_fig/teaser.jpg" alt="Main Results">
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Metalenses offer significant potential for ultra-compact computational imaging but face challenges from complex optical degradation and computational restoration difficulties. 
            Existing methods typically rely on precise optical calibration or massive paired datasets, which are non-trivial for real-world imaging systems. Furthermore, a lack of control over the inference process often results in undesirable hallucinated artifacts.
            We introduce Degradation-Modeled Multipath Diffusion for tunable metalens photography, leveraging powerful natural image priors from pretrained models instead of large datasets. Our framework uses positive, neutral, and negative-prompt paths to balance high-frequency detail generation, structural fidelity, and suppression of metalens-specific degradation, alongside <i>pseudo</i> data augmentation. A tunable decoder enables controlled trade-offs between fidelity and perceptual quality. Additionally, a spatially varying degradation-aware attention (SVDA) module adaptively models complex optical and sensor-induced degradation.
            Finally, we design and build a millimeter-scale MetaCamera for real-world validation. Extensive results show that our approach outperforms state-of-the-art methods, achieving high-fidelity and sharp image reconstruction. More materials: <i><a href="https://dmdiff.github.io/">https://dmdiff.github.io/</a></i>.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method Overview</h2>
        <div class="content has-text-justified">
          <p>
            To tackle the challenges of metalens-based imaging, we propose a degradation-modeled multipath diffusion framework that leverages pretrained large-scale generative diffusion models for tunable metalens photography. Our approach addresses three key challenges: complex metalens degradations, limited paired training data, and hallucinations in generative models.

            With the powerful natural image priors from the base generative diffusion model, our method reconstructs vivid and realistic images using a small training dataset. To further enhance restoration, we propose a Spatially Varying Degradation-Aware (SVDA) attention module, which quantifies optical aberrations and sensor-induced noise to guide the restoration process. Additionally, we introduce a Degradation-modeled Multipath Diffusion (DMDiff) framework, incorporating positive, neutral, and negative-prompt paths to balance detail enhancement and structural fidelity while mitigating metalens-specific distortions. Finally, we design an instantly tunable decoder, enabling dynamic control over reconstruction quality to suppress hallucinations.
          </p>
          <img src="./projects/DMDiff_fig/multipath_diffusion_model.jpg" alt="Overview for our method">
          <br><br>
          <img src="./projects/DMDiff_fig/training_and_inference.jpg" alt="Overview for our method">
      </div>
    </div>
  </div>
</div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">More Results</h2>
        <div class="content has-text-justified">
          <figure>
            <img src="./projects/DMDiff_fig/supp_exp_1.jpg" alt="Qualitative results for our method">
            <figcaption>Qualitative comparisons of different methods on real-world images captured by our system.</figcaption>
          </figure>
        </div>
        <div class="content has-text-justified">
          <figure>
            <img src="./projects/DMDiff_fig/supp_exp_2.jpg" alt="Qualitative results for our method">
            <figcaption>Qualitative comparisons of different methods on our unseen test dataset, zoom in for details.</figcaption>
          </figure>
        </div>
        <hr>
        <h2 class="title is-4">Instantly Tunable Decoding demonstration(Î±:0-1.3)</h2>
        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-6 has-text-centered">
            <img src="./projects/DMDiff_fig/input_1.jpg" class="interpolation-image" alt="Interpolate start reference image.">
            <p>Input</p>
          </div>
          <div class="column interpolation-video-column is-centered">
            <div id="interpolation-image-wrapper" class="is-centered"><img src="./projects/DMDiff_fig/000003.jpg"></div>
            <input class="slider is-fullwidth is-large is-info" id="interpolation-slider" step="1" min="0" max="13" value="3" type="range">
          </div>
        </div>
        
        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-6 has-text-centered">
            <img src="./projects/DMDiff_fig/input_2.jpg" class="interpolation-image" alt="Interpolate start reference image.">
            <p>Input</p>
          </div>
          <div class="column interpolation-video-column is-centered">
            <div id="interpolation-image-wrapper2" class="is-centered"><img src="./projects/DMDiff_fig/000003(1).jpg"></div>
            <input class="slider is-fullwidth is-large is-info" id="interpolation-slider2" step="1" min="0" max="13" value="3" type="range">
          </div>
        </div>


        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-6 has-text-centered">
            <img src="./projects/DMDiff_fig/input_3.jpg" class="interpolation-image" alt="Interpolate start reference image.">
            <p>Input</p>
          </div>
          <div class="column interpolation-video-column is-centered">
            <div id="interpolation-image-wrapper3" class="is-centered"><img src="./projects/DMDiff_fig/000003(2).jpg"></div>
            <input class="slider is-fullwidth is-large is-info" id="interpolation-slider3" step="1" min="0" max="13" value="3" type="range">
          </div>
        </div>

        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-6 has-text-centered">
            <img src="./projects/DMDiff_fig/input_4.jpg" class="interpolation-image" alt="Interpolate start reference image.">
            <p>Input</p>
          </div>
          <div class="column interpolation-video-column is-centered">
            <div id="interpolation-image-wrapper4" class="is-centered"><img src="./projects/DMDiff_fig/000003(3).jpg"></div>
            <input class="slider is-fullwidth is-large is-info" id="interpolation-slider4" step="1" min="0" max="13" value="3" type="range">
          </div>
        </div>
      </div>
    </div>
  </div>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>
      @article{zhang2025dmdiff,
        title={Degradation-Modeled Multipath Diffusion for Tunable Metalens Photography},
        author={Jianing Zhang, Jiayi Zhu, Feiyu Ji, Xiaokang Yang, and Xiaoyun Yuan},
        booktitle={arxiv preprint arxiv:2506.22753}, 
        year={2025}
      }
      </code></pre>
  </div>
</section>
