<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Generative AI + Computational Imaging</title>

  <!-- Google tag (gtag.js) -->
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  
  <style>
    .navbar {
      background-color: #f8f9fa;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .navbar-item {
      color: #333;
      font-weight: 500;
    }
    .navbar-item:hover {
      background-color: #e9ecef;
      color: #007bff;
    }
    .navbar-dropdown .navbar-item.is-active {
      background-color: #007bff;
      color: white;
    }
    #content-container {
      min-height: calc(100vh - 200px);
      padding: 2rem 0;
    }
    .content-section {
      animation: fadeIn 0.5s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .loading {
      text-align: center;
      padding: 5rem;
    }
  </style>
</head>
<body>

<!-- 导航栏 - 修改为下拉菜单 -->
<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="#">
      <strong>Generative AI + Computational Imaging</strong>
    </a>
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  
  <div class="navbar-menu">
    <div class="navbar-start">
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" id="project-dropdown-link">
          Projects
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item project-item is-active" data-target="3m-ti">3M-TI</a>
        </div>
      </div>
      <a class="navbar-item" data-target="about">About</a>
    </div>
  </div>
</nav>

<!-- 内容容器 -->
<div class="container is-max-desktop">
  <div id="content-container">
    <div class="loading">
      <i class="fas fa-spinner fa-spin fa-3x"></i>
      <p class="is-size-4 mt-4">Loading content...</p>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            We thank <a href="https://github.com/nerfies/nerfies.github.io" target="_blank">Nerfies</a> for their amazing template.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- 导航和内容加载脚本 -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const contentContainer = document.getElementById('content-container');
    const projectItems = document.querySelectorAll('.project-item');
    const navbarItems = document.querySelectorAll('.navbar-item[data-target]'); // 包含所有可点击项
    const projectDropdownLink = document.getElementById('project-dropdown-link');

    // --- 路径配置 ---
    // 在开发环境中，如果你使用本地服务器，路径通常是相对的
    // 如果直接打开文件(不推荐)，可能需要绝对路径，但浏览器通常会阻止
    // const CONTENT_BASE_PATH = '.'; // 修改这里：如果HTML文件在根目录，保持'.'；如果在子目录，例如 '/pages'，则修改为 '/pages'
    const CONTENT_BASE_PATH = '.'; // 修改这里：如果HTML文件在根目录，保持'.'；如果在子目录，例如 '/pages'，则修改为 '/pages'
    
    const contentPaths = {
      '3m-ti': `${CONTENT_BASE_PATH}/projects/3MTI.html`,
      'about': `${CONTENT_BASE_PATH}/about.html`
    };
    
    // 初始加载第一个项目
    loadContent('3m-ti');
    
    // 为所有导航项添加点击事件
    navbarItems.forEach(item => {
      item.addEventListener('click', function() {
        const target = this.getAttribute('data-target');
        
        // 更新导航栏激活状态
        navbarItems.forEach(nav => nav.classList.remove('is-active'));
        this.classList.add('is-active');
        
        // 如果点击的是项目，更新下拉菜单的显示文本
        if (this.classList.contains('project-item')) {
            projectDropdownLink.textContent = this.textContent;
        }
        
        // 加载内容
        loadContent(target);
        
        // 滚动到页面顶部
        window.scrollTo(0, 0);
      });
    });
    
    // 加载内容函数
    function loadContent(target) {
      const filePath = contentPaths[target];
      
      if (!filePath) {
          contentContainer.innerHTML = `<div class="has-text-centered"><p class="is-size-4 mt-4">Content not found for '${target}'</p></div>`;
          return;
      }

      contentContainer.innerHTML = `
        <div class="loading">
          <i class="fas fa-spinner fa-spin fa-3x"></i>
          <p class="is-size-4 mt-4">Loading ${target}...</p>
        </div>
      `;
      
      fetch(filePath)
        .then(response => {
          if (!response.ok) {
            console.error(`HTTP error! status: ${response.status} for URL: ${filePath}`);
            throw new Error(`Failed to load (${response.status})`);
          }
          return response.text();
        })
        .then(html => {
          contentContainer.innerHTML = `<div class="content-section">${html}</div>`;
          
          // 重新初始化MathJax
          if (window.MathJax) {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
          }
          
          initScripts();
        })
        .catch(error => {
          console.error('Error loading content:', error);
          contentContainer.innerHTML = `
            <div class="has-text-centered">
              <i class="fas fa-exclamation-triangle fa-3x" style="color: #ff0000;"></i>
              <p class="is-size-4 mt-4">Error loading content</p>
              <p class="is-size-5 mt-2">Please check the console for details. Ensure you are running a local server.</p>
              <p class="is-size-6 mt-1">Path attempted: <code>${filePath}</code></p>
            </div>
          `;
        });
    }
    
    function initScripts() {
      // 在这里可以重新初始化页面上的脚本，例如轮播图等
      // 例如: bulmaCarousel.attach('#some-carousel-id');
    }
    
    // 移动端导航菜单
    const burger = document.querySelector('.navbar-burger');
    const menu = document.querySelector('.navbar-menu');
    
    burger.addEventListener('click', function() {
      burger.classList.toggle('is-active');
      menu.classList.toggle('is-active');
    });
  });
</script>

</body>
</html>